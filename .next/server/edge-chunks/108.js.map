{"version":3,"file":"edge-chunks/108.js","mappings":"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tB,KAAM2B,EACNQ,KAAM,QACNC,OAAQ,CACNC,WAAY,iBACZC,SAAU,iBACVC,OAAQ,GACRC,QAAS,UACTC,KAAM,sDACNC,KAAM,0CACR,EACAC,MAAO,CACLC,GAAI,EACJC,KAAM,mBACNC,KAAM,QACR,EACAC,UAAW,CACTC,SAAU,QACVX,WAAY,UACZC,SAAU,UACVC,OAAQ,GACRE,KAAM,mDACR,EACAQ,UAAW,CACTD,SAAU,QACVX,WAAY,UACZC,SAAU,UACVC,OAAQ,GACRE,KAAM,mDACR,CACF,EACAlB,OAAQ,CACN,MAAO,CACL2B,GAAI,CACFC,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,KACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACT,CACF,EACAG,EAAG,CACDP,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,GACT,CACF,EACAI,GAAI,CACFR,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,GACT,CACF,CACF,EACAK,OAAQ,CACN,MAAO,CACLC,KAAM,CACJV,GAAI,KACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,KACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACT,CACF,EACAO,MAAO,CACLX,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,EACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,CACT,CACF,CACF,EACA,MAAO,CACLM,KAAM,CACJV,GAAI,KACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,GACT,CACF,EACAO,MAAO,CACLX,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,EACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,CACT,CACF,CACF,EACA,MAAO,CACLM,KAAM,CACJV,GAAI,KACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,KACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACT,CACF,EACAO,MAAO,CACLX,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,GACT,CACF,CACF,EACA,MAAO,CACLM,KAAM,CACJV,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,GACT,CACF,EACAO,MAAO,CACLX,GAAI,KACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,SAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,SAChBC,MAAO,GACT,CACF,CACF,CACF,CACF,CACF,EACA,CACEzB,SAAU,eACVC,aAAc,CACZC,WAAY,OACZC,aAAc,YACdC,UAAW,IAAIpC,OAAOM,WAAW,EACnC,EACAkB,YAAa,CACXtB,KAAM6B,EACNM,KAAM,QACNC,OAAQ,CACNC,WAAY,UACZC,SAAU,UACVC,OAAQ,IACRC,QAAS,QACTC,KAAM,uDACNC,KAAM,0CACR,EACAC,MAAO,CACLC,GAAI,EACJC,KAAM,uBACNC,KAAM,QACR,EACAC,UAAW,CACTC,SAAU,QACVX,WAAY,cACZC,SAAU,cACVC,OAAQ,IACRE,KAAM,oDACR,EACAQ,UAAW,CACTD,SAAU,QACVX,WAAY,YACZC,SAAU,YACVC,OAAQ,IACRE,KAAM,oDACR,CACF,EACAlB,OAAQ,CACN,MAAO,CACL2B,GAAI,CACFC,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,EACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,CACT,CACF,EACAG,EAAG,CACDP,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,EACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,CACT,CACF,EACAI,GAAI,CACFR,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,GACT,CACF,CACF,EACAK,OAAQ,CACN,MAAO,CACLC,KAAM,CACJV,GAAI,KACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,KACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,IACT,CACF,EACAO,MAAO,CACLX,GAAI,GACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,GACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,EACT,CACF,CACF,EACA,MAAO,CACLM,KAAM,CACJV,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,KACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,IACT,CACF,EACAO,MAAO,CACLX,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,GACT,CACF,CACF,EACA,MAAO,CACLM,KAAM,CACJV,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,EACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,CACT,CACF,EACAO,MAAO,CACLX,GAAI,KACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,KACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,IACT,CACF,CACF,EACA,MAAO,CACLM,KAAM,CACJV,GAAI,IACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,IACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,GACT,CACF,EACAO,MAAO,CACLX,GAAI,KACJC,eAAgB,CACd,CACEC,aAAc,EACdC,eAAgB,UAChBC,MAAO,KACPC,UAAW,EACb,EACD,CACDC,YAAa,CACXJ,aAAc,EACdC,eAAgB,UAChBC,MAAO,IACT,CACF,CACF,CACF,CACF,CACF,EACD,AACH","sources":["webpack://_N_E/./src/lib/data-fetcher.ts"],"sourcesContent":["import { Match } from './types'\n\nconst BUCKET_URL = 'https://storage.yandexcloud.net/screen-shared'\nconst FOLDER_PATH = 'merged-matches'\n\n// –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Yandex Cloud Storage (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤ –†–æ—Å—Å–∏–∏)\nconst USE_PROXY = false\nconst PROXY_ENDPOINT = '/api/s3-proxy'\n\nexport async function fetchFileWithFallback(filePath: string): Promise<Match | null> {\n  try {\n    let url: string\n\n    if (USE_PROXY) {\n      // –ß–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ - –æ–±—Ö–æ–¥–∏–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤\n      url = `${PROXY_ENDPOINT}?path=${encodeURIComponent(filePath)}`\n    } else {\n      // –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ S3 (–º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è)\n      url = filePath.startsWith('http') ? filePath : `${BUCKET_URL}/${filePath}`\n    }\n\n    const response = await fetch(url)\n    if (response.status === 404) {\n      return null\n    }\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`)\n    }\n    return await response.json()\n  } catch (error) {\n    console.error(`Error fetching ${filePath}:`, error)\n    return null\n  }\n}\n\nexport async function getS3FileList(bucketUrl: string, prefix: string): Promise<string[] | null> {\n  try {\n    let listUrl: string\n\n    if (USE_PROXY) {\n      // –ß–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ - –æ–±—Ö–æ–¥–∏–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤\n      listUrl = `${PROXY_ENDPOINT}?action=list&path=${encodeURIComponent(prefix)}`\n      console.log(`üóÇÔ∏è Using proxy for S3 ListObjects: ${prefix}`)\n    } else {\n      // –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ S3 (–º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è)\n      listUrl = `${bucketUrl}/?list-type=2&prefix=${encodeURIComponent(prefix)}`\n      console.log(`üóÇÔ∏è Direct S3 ListObjects: ${listUrl}`)\n    }\n\n    const response = await fetch(listUrl, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/xml'\n      }\n    })\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`)\n    }\n\n    const xmlText = await response.text()\n\n    // Parse XML response\n    const parser = new DOMParser()\n    const xmlDoc = parser.parseFromString(xmlText, 'text/xml')\n\n    // Check for errors\n    const error = xmlDoc.getElementsByTagName('Error')[0]\n    if (error) {\n      const code = error.getElementsByTagName('Code')[0]?.textContent\n      throw new Error(`S3 Error: ${code}`)\n    }\n\n    // Extract files\n    const contents = xmlDoc.getElementsByTagName('Contents')\n    const files: string[] = []\n\n    for (let i = 0; i < contents.length; i++) {\n      const keyElement = contents[i].getElementsByTagName('Key')[0]\n      if (keyElement) {\n        const key = keyElement.textContent\n        if (key && key.endsWith('.json')) {\n          files.push(key)\n        }\n      }\n    }\n\n    console.log(`‚úÖ S3 API returned ${files.length} files`)\n    return files\n\n  } catch (error) {\n    console.log(`‚ùå S3 API failed: ${error}`)\n    return null\n  }\n}\n\nexport async function loadSampleData(): Promise<Match[]> {\n  try {\n    const response = await fetch('/api/sample-data')\n    if (response.ok) {\n      const data = await response.json()\n      return Array.isArray(data) ? data : [data]\n    }\n    throw new Error('Sample data not available')\n  } catch (error) {\n    console.error('Error loading sample data:', error)\n    return generateFallbackData()\n  }\n}\n\nfunction getDateFolders(): string[] {\n  const today = new Date()\n  const folders: string[] = []\n\n  // Generate date folders for today + 7 days forward\n  for (let i = 0; i <= 7; i++) {\n    const date = new Date(today)\n    date.setDate(today.getDate() + i)\n    const dateStr = date.toISOString().split('T')[0] // YYYY-MM-DD format\n    folders.push(`${FOLDER_PATH}/${dateStr}`)\n  }\n\n  return folders\n}\n\nexport async function loadMatchesFromS3(): Promise<Match[]> {\n  try {\n    const dateFolders = getDateFolders()\n    console.log(`üóìÔ∏è Searching for matches in date folders: ${dateFolders.map(f => f.split('/').pop()).join(', ')}`)\n\n    const allFiles: string[] = []\n\n    // Get files from each date folder\n    for (const folder of dateFolders) {\n      const fileList = await getS3FileList(BUCKET_URL, folder + '/')\n      if (fileList && fileList.length > 0) {\n        console.log(`üìÅ Found ${fileList.length} files in ${folder.split('/').pop()}`)\n        allFiles.push(...fileList)\n      }\n    }\n\n    if (allFiles.length === 0) {\n      console.log('No S3 files found in date range, falling back to sample data')\n      return await loadSampleData()\n    }\n\n    console.log(`Found ${allFiles.length} total files, loading...`)\n\n    // Load files in batches to avoid overwhelming the browser\n    const BATCH_SIZE = 20\n    const allMatches: Match[] = []\n\n    for (let i = 0; i < allFiles.length; i += BATCH_SIZE) {\n      const batch = allFiles.slice(i, i + BATCH_SIZE)\n      const promises = batch.map(async (filePath) => {\n        // fetchFileWithFallback —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–∫—Å–∏, –µ—Å–ª–∏ USE_PROXY = true\n        return await fetchFileWithFallback(filePath)\n      })\n\n      const results = await Promise.all(promises)\n      const validMatches = results.filter((data): data is Match =>\n        data !== null && !!data.match_basic && !!data.events\n      )\n\n      allMatches.push(...validMatches)\n      console.log(`Loaded batch ${Math.floor(i / BATCH_SIZE) + 1}/${Math.ceil(allFiles.length / BATCH_SIZE)}: ${validMatches.length} matches`)\n    }\n\n    console.log(`Loaded ${allMatches.length} total matches from S3`)\n    return allMatches\n\n  } catch (error) {\n    console.error('Error loading from S3:', error)\n    console.log('Fallback to sample data')\n    return await loadSampleData()\n  }\n}\n\nexport function generateFallbackData(): Match[] {\n  const today = new Date()\n  const todayStr = today.toISOString().split('T')[0]\n  const tomorrow = new Date(today)\n  tomorrow.setDate(today.getDate() + 1)\n  const tomorrowStr = tomorrow.toISOString().split('T')[0]\n\n  return [\n    {\n      match_id: \"demo_match_1\",\n      mapping_info: {\n        confidence: \"high\",\n        match_reason: \"demo_data\",\n        merged_at: new Date().toISOString()\n      },\n      match_basic: {\n        date: todayStr,\n        time: \"15:00\",\n        league: {\n          fbref_name: \"Premier League\",\n          api_name: \"Premier League\",\n          api_id: 39,\n          country: \"England\",\n          logo: \"https://media.api-sports.io/football/leagues/39.png\",\n          flag: \"https://media.api-sports.io/flags/gb.svg\"\n        },\n        venue: {\n          id: 1,\n          name: \"Emirates Stadium\",\n          city: \"London\"\n        },\n        home_team: {\n          fbref_id: \"demo1\",\n          fbref_name: \"Arsenal\",\n          api_name: \"Arsenal\",\n          api_id: 42,\n          logo: \"https://media.api-sports.io/football/teams/42.png\"\n        },\n        away_team: {\n          fbref_id: \"demo2\",\n          fbref_name: \"Chelsea\",\n          api_name: \"Chelsea\",\n          api_id: 49,\n          logo: \"https://media.api-sports.io/football/teams/49.png\"\n        }\n      },\n      events: {\n        \"1x2\": {\n          P1: {\n            ml: 2.1,\n            bookmaker_odds: [\n              {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 2.25,\n                is_better: true\n              }\n            ],\n            better_odds: {\n              bookmaker_id: 4,\n              bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n              value: 2.25\n            }\n          },\n          X: {\n            ml: 3.4,\n            bookmaker_odds: [\n              {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 3.6,\n                is_better: true\n              }\n            ],\n            better_odds: {\n              bookmaker_id: 4,\n              bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n              value: 3.6\n            }\n          },\n          P2: {\n            ml: 3.2,\n            bookmaker_odds: [\n              {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 3.4,\n                is_better: true\n              }\n            ],\n            better_odds: {\n              bookmaker_id: 4,\n              bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n              value: 3.4\n            }\n          }\n        },\n        totals: {\n          \"0.5\": {\n            over: {\n              ml: 1.08,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 4,\n                  bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                  value: 1.12,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 1.12\n              }\n            },\n            under: {\n              ml: 8.5,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 4,\n                  bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                  value: 9.0,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 9.0\n              }\n            }\n          },\n          \"1.5\": {\n            over: {\n              ml: 1.25,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 4,\n                  bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                  value: 1.30,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 1.30\n              }\n            },\n            under: {\n              ml: 3.8,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 4,\n                  bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                  value: 4.0,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 4.0\n              }\n            }\n          },\n          \"2.5\": {\n            over: {\n              ml: 1.75,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 4,\n                  bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                  value: 1.85,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 1.85\n              }\n            },\n            under: {\n              ml: 2.1,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 4,\n                  bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                  value: 2.2,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 2.2\n              }\n            }\n          },\n          \"3.5\": {\n            over: {\n              ml: 3.6,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 4,\n                  bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                  value: 3.8,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 3.8\n              }\n            },\n            under: {\n              ml: 1.35,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 4,\n                  bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                  value: 1.40,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 4,\n                bookmaker_name: \"–§–æ–Ω–±–µ—Ç\",\n                value: 1.40\n              }\n            }\n          }\n        }\n      }\n    },\n    {\n      match_id: \"demo_match_2\",\n      mapping_info: {\n        confidence: \"high\",\n        match_reason: \"demo_data\",\n        merged_at: new Date().toISOString()\n      },\n      match_basic: {\n        date: tomorrowStr,\n        time: \"17:30\",\n        league: {\n          fbref_name: \"La Liga\",\n          api_name: \"La Liga\",\n          api_id: 140,\n          country: \"Spain\",\n          logo: \"https://media.api-sports.io/football/leagues/140.png\",\n          flag: \"https://media.api-sports.io/flags/es.svg\"\n        },\n        venue: {\n          id: 2,\n          name: \"Santiago Bernab√©u\",\n          city: \"Madrid\"\n        },\n        home_team: {\n          fbref_id: \"demo3\",\n          fbref_name: \"Real Madrid\",\n          api_name: \"Real Madrid\",\n          api_id: 541,\n          logo: \"https://media.api-sports.io/football/teams/541.png\"\n        },\n        away_team: {\n          fbref_id: \"demo4\",\n          fbref_name: \"Barcelona\",\n          api_name: \"Barcelona\",\n          api_id: 529,\n          logo: \"https://media.api-sports.io/football/teams/529.png\"\n        }\n      },\n      events: {\n        \"1x2\": {\n          P1: {\n            ml: 1.9,\n            bookmaker_odds: [\n              {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 2.0,\n                is_better: true\n              }\n            ],\n            better_odds: {\n              bookmaker_id: 2,\n              bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n              value: 2.0\n            }\n          },\n          X: {\n            ml: 3.8,\n            bookmaker_odds: [\n              {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 4.0,\n                is_better: true\n              }\n            ],\n            better_odds: {\n              bookmaker_id: 2,\n              bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n              value: 4.0\n            }\n          },\n          P2: {\n            ml: 3.5,\n            bookmaker_odds: [\n              {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 3.7,\n                is_better: true\n              }\n            ],\n            better_odds: {\n              bookmaker_id: 2,\n              bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n              value: 3.7\n            }\n          }\n        },\n        totals: {\n          \"0.5\": {\n            over: {\n              ml: 1.05,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 2,\n                  bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                  value: 1.08,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 1.08\n              }\n            },\n            under: {\n              ml: 12.0,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 2,\n                  bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                  value: 13.0,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 13.0\n              }\n            }\n          },\n          \"1.5\": {\n            over: {\n              ml: 1.30,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 2,\n                  bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                  value: 1.35,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 1.35\n              }\n            },\n            under: {\n              ml: 3.5,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 2,\n                  bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                  value: 3.7,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 3.7\n              }\n            }\n          },\n          \"2.5\": {\n            over: {\n              ml: 1.90,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 2,\n                  bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                  value: 2.0,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 2.0\n              }\n            },\n            under: {\n              ml: 1.95,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 2,\n                  bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                  value: 2.05,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 2.05\n              }\n            }\n          },\n          \"3.5\": {\n            over: {\n              ml: 4.2,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 2,\n                  bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                  value: 4.4,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 4.4\n              }\n            },\n            under: {\n              ml: 1.28,\n              bookmaker_odds: [\n                {\n                  bookmaker_id: 2,\n                  bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                  value: 1.32,\n                  is_better: true\n                }\n              ],\n              better_odds: {\n                bookmaker_id: 2,\n                bookmaker_name: \"–í–∏–Ω–ª–∞–π–Ω\",\n                value: 1.32\n              }\n            }\n          }\n        }\n      }\n    }\n  ]\n}"],"names":["BUCKET_URL","fetchFileWithFallback","filePath","url","startsWith","response","fetch","status","ok","json","error","console","getS3FileList","bucketUrl","prefix","listUrl","encodeURIComponent","log","method","headers","statusText","xmlText","text","xmlDoc","parser","DOMParser","parseFromString","getElementsByTagName","code","textContent","contents","files","i","length","keyElement","key","endsWith","push","loadSampleData","data","Array","isArray","generateFallbackData","loadMatchesFromS3","dateFolders","getDateFolders","today","Date","folders","date","setDate","getDate","dateStr","toISOString","split","map","f","pop","join","allFiles","folder","fileList","allMatches","promises","batch","slice","validMatches","results","Promise","all","filter","match_basic","events","Math","floor","ceil","todayStr","tomorrow","tomorrowStr","match_id","mapping_info","confidence","match_reason","merged_at","time","league","fbref_name","api_name","api_id","country","logo","flag","venue","id","name","city","home_team","fbref_id","away_team","P1","ml","bookmaker_odds","bookmaker_id","bookmaker_name","value","is_better","better_odds","X","P2","totals","over","under"],"sourceRoot":""}